# ğŸš€ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ Kubernetes ë°°í¬ 

## ğŸ¯ ì‹¤ìŠµ ëª©ì 
- Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì»¨í…Œì´ë„ˆí™”í•˜ëŠ” ë°©ë²• í•™ìŠµ
- Kubernetes ê¸°ë³¸ ê°œë… ì´í•´ (Deployment, Service, Pod)
- ë¡œì»¬ ê°œë°œ í™˜ê²½ì—ì„œ Kubernetes í´ëŸ¬ìŠ¤í„° ìš´ì˜ ê²½í—˜
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ì˜ ê¸°ì´ˆ ì´í•´
- ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§ ë°©ë²• ìŠµë“


## ğŸ›  ì‚¬ìš© ê¸°ìˆ 

![Java](https://img.shields.io/badge/java-%23ED8B00.svg?style=for-the-badge&logo=openjdk&logoColor=white)
![Spring](https://img.shields.io/badge/spring-%236DB33F.svg?style=for-the-badge&logo=spring&logoColor=white)
![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white)
![Kubernetes](https://img.shields.io/badge/kubernetes-%23326ce5.svg?style=for-the-badge&logo=kubernetes&logoColor=white)
![Gradle](https://img.shields.io/badge/Gradle-02303A.svg?style=for-the-badge&logo=Gradle&logoColor=white)


## ğŸ—ï¸ ì‚¬ì „ ì¤€ë¹„
1. Java JDK 17 ì„¤ì¹˜
   ```bash
   java -version
   ```
2. Docker ì„¤ì¹˜
   ```bash
   docker --version
   ```
3. Minikube ì„¤ì¹˜
   ```bash
   minikube version
   ```
4. kubectl ì„¤ì¹˜
   ```bash
   kubectl version --client
   ```


## ğŸ“¦ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤€ë¹„

1. í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸
   ```
   src
   â”œâ”€â”€ main
   â”‚   â”œâ”€â”€ java
   â”‚   â”‚   â””â”€â”€ com
   â”‚   â”‚       â””â”€â”€ example
   â”‚   â”‚           â””â”€â”€ demo
   â”‚   â”‚               â”œâ”€â”€ DemoApplication.java
   â”‚   â”‚               â””â”€â”€ controller
   â”‚   â”‚                   â””â”€â”€ TestController.java
   â”‚   â””â”€â”€ resources
   â”‚       â””â”€â”€ application.properties
   â””â”€â”€ test
   ```

2. TestController.java ë‚´ìš©
   ```java
   @RestController
   @Slf4j
   public class TestController {
       @GetMapping("/test")
       public String test() {
           log.info("ìš”ì²­ ìˆ˜ë½ ~~~");
           return "cicd";
       }
   }
   ```

3. application.properties ì„¤ì •
   ```properties
   server.port=8999
   ```

4. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ
   ```bash
   ./gradlew build
   ```


## ğŸ³ Docker ì´ë¯¸ì§€ ë¹Œë“œ

1. Dockerfile ìƒì„±
   ```dockerfile
   FROM openjdk:17-jdk-slim
   COPY build/libs/demo-0.0.1-SNAPSHOT.jar app.jar
   ENTRYPOINT ["java","-jar","/app.jar"]
   ```

2. Docker ì´ë¯¸ì§€ ë¹Œë“œ
   ```bash
   docker build -t springapp:v1 .
   ```

3. ì´ë¯¸ì§€ í™•ì¸
   ```bash
   docker images | grep springapp
   ```


## â˜¸ï¸ Kubernetes ë°°í¬

1. Minikube ì‹œì‘
   ```bash
   minikube start
   ```

2. Minikube Docker í™˜ê²½ ì‚¬ìš©
   ```bash
   eval $(minikube docker-env)
   ```

3. ì´ë¯¸ì§€ ë‹¤ì‹œ ë¹Œë“œ (Minikube í™˜ê²½ì—ì„œ)
   ```bash
   docker build -t springapp:v1 .
   ```

4. Kubernetes Deployment ìƒì„±
   ```bash
   kubectl create deployment springapp --image=springapp:v1 --replicas=3
   ```

5. ë°°í¬ ìƒíƒœ í™•ì¸
   ```bash
   kubectl get deployments
   kubectl get pods
   ```


## ğŸŒ ì„œë¹„ìŠ¤ ë…¸ì¶œ ë° ì ‘ê·¼

1. ì„œë¹„ìŠ¤ ìƒì„± (LoadBalancer íƒ€ì…)
   ```bash
   kubectl expose deployment springapp --type=LoadBalancer --port=8999
   ```

2. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
   ```bash
   kubectl get services
   ```

3. Minikube tunnel ì‹¤í–‰ (ìƒˆ í„°ë¯¸ë„ì—ì„œ)
   ```bash
   minikube tunnel
   ```

4. ì„œë¹„ìŠ¤ EXTERNAL-IP í™•ì¸
   ```bash
   kubectl get services
   ```
   ![image](https://github.com/user-attachments/assets/ec411879-3d0a-48b7-b460-3936aae5cdc1)

   Dashboardì—ì„œ í™•ì¸
   ![image](https://github.com/user-attachments/assets/d10d2b7a-32c7-4a6d-8fc2-2be07d0f4757)


6. í¬íŠ¸í¬ì›Œë”©
   ![image](https://github.com/user-attachments/assets/f568a5c8-08a5-43f7-bdc4-4f0e92f0c62f)


7. ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ê·¼
   `http://10.111.60.72:1565/test`
   ![image](https://github.com/user-attachments/assets/13a6af51-8092-4ac8-9248-b3132b472e50)



## ğŸ“Š ë¡œê·¸ í™•ì¸ ë° ëª¨ë‹ˆí„°ë§

1. ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
   ```bash
   kubectl logs -f -l app=springapp
   ```

2. íŠ¹ì • í‚¤ì›Œë“œë¡œ ë¡œê·¸ í•„í„°ë§
   ```bash
   kubectl logs -f -l app=springapp | grep "ìš”ì²­ ìˆ˜ë½"
   ```
   ![image](https://github.com/user-attachments/assets/3ac60a86-2fad-421e-aa0e-77524e02dd2a)


3. Dashboard í™•ì¸
   ![image](https://github.com/user-attachments/assets/52c122c0-7040-4d55-a585-d4e32d8ea57b)


## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ì„œë¹„ìŠ¤ ì ‘ê·¼ ë¶ˆê°€
- ì¦ìƒ: ë¸Œë¼ìš°ì €ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŒ
- í•´ê²° ë°©ë²•:
  1. ì„œë¹„ìŠ¤ ìƒíƒœ ì¬í™•ì¸
     ```bash
     kubectl describe service springapp
     ```
  2. Minikube tunnel ì‹¤í–‰ ìƒíƒœ í™•ì¸
  3. ë°©í™”ë²½ ì„¤ì • í™•ì¸
  4. í¬íŠ¸ í¬ì›Œë”© ì‹œë„

### ë¬¸ì œ 2: 404 ì—ëŸ¬ (Whitelabel Error Page)
- ì¦ìƒ: ë¸Œë¼ìš°ì €ì—ì„œ "Whitelabel Error Page" í‘œì‹œ
- í•´ê²° ë°©ë²•:
  1. ì»¨íŠ¸ë¡¤ëŸ¬ ë§¤í•‘ í™•ì¸
  2. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ê²€ì‚¬
     ```bash
     kubectl logs -l app=springapp
     ```
  3. ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œ ë° í¬íŠ¸ ì„¤ì • í™•ì¸
  4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘
     ```bash
     kubectl rollout restart deployment springapp
     ```


## ğŸ§¹ ì •ë¦¬ ë° ì‚­ì œ

1. ì„œë¹„ìŠ¤ ì‚­ì œ
   ```bash
   kubectl delete service springapp
   ```

2. ë””í”Œë¡œì´ë¨¼íŠ¸ ì‚­ì œ
   ```bash
   kubectl delete deployment springapp
   ```

3. Minikube í´ëŸ¬ìŠ¤í„° ì‚­ì œ
   ```bash
   minikube delete
   ```
   

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

ì•„ë˜ëŠ” Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì´ Kubernetes (Minikube) í™˜ê²½ì—ì„œ ì–´ë–»ê²Œ ë°°í¬ë˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê°„ë‹¨í•œ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ì…ë‹ˆë‹¤:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Minikube Cluster                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Kubernetes Namespace                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚   Deployment    â”‚      â”‚         Service (LoadBalancer)  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚                                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Pod       â”‚  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚      â”‚  â”‚ External IP â”‚                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â”‚SpringAppâ”‚â—„â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¤   :8999    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”¼â”€â”€â”€â”€â”
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚                                 â”‚ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ Pod       â”‚  â”‚                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â”‚SpringAppâ”‚â—„â”€â”¼â”€â”€â”€â”€â”€â”€â”¤        Metrics Server           â”‚ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ Pod       â”‚  â”‚      â”‚         ConfigMap/Secrets       â”‚ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚      â”‚   (Application Configuration)   â”‚ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â”‚SpringAppâ”‚â—„â”€â”¼â”€â”€â”€â”€â”€â”€â”¤                                 â”‚ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                          â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                                                                           â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
                            â”‚    Client Access    â”‚                        â”‚
                            â”‚  (Browser/API Call) â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### êµ¬ì„± ìš”ì†Œ ì„¤ëª…:

1. **Minikube Cluster**: ë¡œì»¬ ê°œë°œ í™˜ê²½ì—ì„œ Kubernetesë¥¼ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.
2. **Kubernetes Namespace**: ë¦¬ì†ŒìŠ¤ë“¤ì„ ë…¼ë¦¬ì ìœ¼ë¡œ êµ¬ë¶„í•©ë‹ˆë‹¤.
3. **Deployment**: Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³µì œë³¸(Pod)ë“¤ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
4. **Pod**: Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ëŠ” ìµœì†Œ ë‹¨ìœ„ì…ë‹ˆë‹¤.
5. **Service (LoadBalancer)**: ì™¸ë¶€ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
6. **Metrics Server**: í´ëŸ¬ìŠ¤í„°ì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì„ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.
7. **ConfigMap/Secrets**: ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„¤ì • ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
8. **Client Access**: ì‚¬ìš©ìë‚˜ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ‘ê·¼í•˜ëŠ” ì§€ì ì…ë‹ˆë‹¤.

ì´ ì•„í‚¤í…ì²˜ëŠ” ê¸°ë³¸ì ì¸ êµ¬ì„±ì„ ë³´ì—¬ì£¼ë©°, ì‹¤ì œ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì¶”ê°€ì ì¸ ì»´í¬ë„ŒíŠ¸ë‚˜ ë³´ì•ˆ ê³„ì¸µì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ğŸ“š ì¶”ê°€ í•™ìŠµ ìë£Œ
- [Kubernetes ê³µì‹ ë¬¸ì„œ](https://kubernetes.io/docs/home/)
- [Spring Boot with Docker](https://spring.io/guides/gs/spring-boot-docker/)
- [Minikube íŠœí† ë¦¬ì–¼](https://minikube.sigs.k8s.io/docs/start/)



ì´ ê°€ì´ë“œë¥¼ í†µí•´ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ Kubernetes í™˜ê²½ì— ì„±ê³µì ìœ¼ë¡œ ë°°í¬í•˜ê³  ìš´ì˜í•˜ëŠ” ë°©ë²•ì„ ìƒì„¸íˆ ìµí ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¤ì œ í™˜ê²½ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ìƒí™©ê³¼ ë¬¸ì œ í•´ê²° ë°©ë²•ë„ í¬í•¨ë˜ì–´ ìˆì–´, ì‹¤ë¬´ì— ë°”ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” ì§€ì‹ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ˜Š
